# ObservePC Ver1.5 (ObservePC-v1.5.zip)
AI対話・技術相談を加速させるPC環境前提情報取得ツール

【Ver1.3アップデート情報】
- Ver1.2のバグを修正。
- 「常駐プロセス一覧」を「サードパーティ製プロセス一覧（常駐候補）」に名称変更しました。

【Ver1.4アップデート情報】
- システム管理者やC#学習者など向けに、出力ファイルをLAN経由で送信するテンプレートコードOutputSender.csを追加（SMB/HTTP/Syslog/SMTP）
- 自動収集項目の追加強化:マザーボード情報拡張、ネットワーク構成情報拡張、OSインストール日、セキュリティ状況(セキュリティソフトの推測)、タスクスケジューラ登録取得

【Ver1.41アップデート情報】
- ObservePC14.zipに実行ファイルを入れ忘れたので、実行ファイルを追加してObservePC141.zipとしてアップロード。
- 単純ミスでの再アップなので実行ファイル追加以外の中身はObservePC14.zipと一緒です

【Ver1.5アップデート情報】
- Ver1.4で肥大化した出力をAI向けに整理縮小。標準で出力しないセクション有り
- 最大出力件数20から10へ減少。セクションの出力順序を最適化。
- 複数PCでの使用を想定して出力ファイル名にマシン名を追加。
- USBメモリ上で起動可能なので複数PCの情報を収集、確認するのが簡単になりました。
- -Eモード新設により管理者など上級ユーザーへの利便性向上。全てのセクション出力。最大出力件数30件へ増加。
- セクション改良:ストレージ構成、接続デバイス一覧、タスクスケジューラ登録情報。
- (BitLocker統合、録音・映像機器の分類、Microsoft製タスク除去)
- セクション新設:削除ソフトの痕跡、異常ドライバー検出、ユーザー情報、環境変数。

【対象環境】
- Windows 11 
- .NET Framework 4.8 以上（WMI使用。現代のWindows環境では標準搭載）
- PowerShell：5.1 以上（7.x 推奨）
- コンソールアプリ（GUIなし）・インストール不要
- 機能強化したら動作可能環境が狭くなったWindows Server 2019 /Windows 10 は対象外です。Ver1.4系を利用してください。

【概要】
ObservePCは、AIとの技術対話やトラブル相談を円滑にするための「前提整形支援ツール」です。
一般的なPC監視ツールとは異なり、以下の情報を一括取得・整形してテキスト形式で出力します：
- 	OS情報
- 	マザーボード情報
- 	CPU・メモリ情報
- 	ストレージ構成
- 	接続デバイス一覧
- 	GPU情報
- 	ディスプレイ情報（代表的な1台。ソースコード同梱により複数台対応に拡張可能）
- 	ネットワーク構成（製造元情報含む）
- 	Windows Update履歴
- 	インストースタートアップアプリ一覧
- 	スタートアップアプリ一覧
- 	サードパーティ製プロセス一覧
- 	環境変数
- 	セキュリティソフトの推測
- 	異常ドライバー検出(簡易)
- 	イベントログ（Error/Warningを抽出。DCOMノイズを除去、最大10件表示。拡張可能）
- 	ユーザーアカウント情報
- 	user_note.txtの内容
- 	+異常ドライバー検出(詳細)
- 	+タスクスケジューラ登録情報
- 	+削除ソフト痕跡（レジストリより推定）
- 	+削除ソフト痕跡（イベントログより確定）
- 	使用者属性の追加

+は-Eオプション時のみ出力。出力上限も10から30へ拡大。出力量が増えるのでAIへの相談より、ご自身でのPC環境把握に適しています。
※診断機能は搭載していません。出力結果をCopilotやGeminiなどのAIに渡すことで、トラブル相談や技術支援が可能になります。
掲示板での相談やユーザーサポートへの連絡にも活用できます。
Windows標準機能でも取得可能な情報ですが、分散しているため一括確認が困難です。上級者の環境確認にも有用です。

【特徴】
- 	出力内容はそのままAIとの対話や技術相談に貼り付け可能
- 	GUIを排し、コピー＆ペーストに最適化。AIとの前提共有における「摩擦」を最小化
- 	使用者の知識レベルや通信スタイルは起動オプションで明示可能
- 	自動取得できない情報やユーザーの知識レベルなどは user_note.txt に追記可能（備忘録としても活用可）
- 	一般的な環境に最適化しつつ、拡張したい人向けにソースコードを同梱

【利用方法】
-   `ObservePC-v1.5.zip` をダウンロードし、解凍します
-   解凍したフォルダ内の実行ファイルを実行します
-   実行には数秒から数十秒かかる場合があります。環境によって異なります。
-   出力されたテキストファイルをAIとの対話にご利用ください
- 	インストール不要。USBメモリに入れて他PCでの実行も可能
- 	レジストリ等に痕跡を残しません
- 	出力はすべてテキスト形式で保存され、AIとの共有に最適化されています

【AIとの連携方法（Copilot / Gemini）】
- 	CopilotやGeminiなどの文字数制限を回避するため、以下のファイルアップロード方式を推奨します。
-   Copilotの右下「+」ボタン（またはGeminiのクリップアイコン）から、出力されたテキストファイル（例:PC_Observation_GESO_20251031.txt）を直接アップロードしてください。全文を一度に渡すことができます。
-   ドロップでもアップロード可能です。
-   ファイルをアップロード後、チャットウィンドウ（画面）に「このファイルの内容を確認して。」と入力し、続けて質問内容を記述して送信すれば、一度の操作で済みます。

【AIへの質問例】
〈基本診断・トラブル解消〉
・このPCを診断して → 普段気づかない不具合が見つかるかも
・このPCが時々重くなるけど、想定される原因と対策を教えて
・起動が遅いのですが、どの項目を確認すれば良いですか？
・Windows Updateが進まない原因を調べてください。

〈ハードウェア・性能相談〉
・このPCのパーツ交換を考えているが、何から変更すれば良いかアドバイスして
・××ゲームを快適にプレイしたい。GPUは交換必要か？候補と価格も教えて
・動画を綺麗に見たい。GPUドライバーと▲▲プレイヤーソフトの設定を教えて
・HDRに設定できないが、原因と対策を教えて（ケーブル規格はuser_note.txtに記入推奨）

〈互換性・設定相談〉
・古いソフトが動かないときの互換モード設定方法を教えてください。
・セキュリティソフトの影響で動作が重い場合の対策を教えてください。

〈AI連携活用〉
・この出力結果をもとにAI診断を行うプロンプト例を提案してください。
・この環境でAI学習用ローカル環境を構築する場合、どの部分を強化すべきですか？


【起動オプション（使用者属性の追加）】

ObservePCは、起動時にオプションを指定することで、出力内容や通信スタイルを調整できます。
これらのオプションは、**AIとのコミュニケーションにおけるトランスポート層（L4）**の役割を果たし、AIの応答スタイルを制御します。

 - -L    初心者向け：「初心者です。専門用語を避け、平易に説明してください。」
 - -H    経験者向け：「経験者です。簡潔に、要点だけを伝えてください。」
 - -M="任意の補足文"   カスタム指定（例：-M="私は管理者です。構造的に応答してください。"）
 - -E 詳細モード:最大出力件数を30に拡大。異常ドライバー検出(詳細)、タスクスケジューラ登録情報、
	    	削除ソフト痕跡（レジストリより推定）、削除ソフト痕跡（イベントログより確定）を追加出力する。

使用例：
- ObservePC.exe -L
- ObservePC.exe -H
- ObservePC.exe -M="私は管理者です。構造的に応答してください。"
- ObservePC.exe -E
  
【開発経緯(前提情報とは)】

AI技術が話題になり、GeminiやWindows付属Copilotなど気軽に使える環境が整ってきました。試しにPC関連の質問をしてみると、返答が的外れなことが多い。
その原因は、AIが私のPC環境を何も知らないことにあると気づきました。コマンドプロンプトのような入力を丁寧に書くと改善されましたが、手を抜くと質が低下。会話が長くなるとさらに悪化し、時間を空けて再開するとまた前提が失われてしまう。
この現象は「AIがPC環境に関する知識を持っていない」ことが原因と考え、毎回会話開始時に与える「前提情報」が必要だと判断しました。
しかし、手動で環境情報を集めるのは非現実的。既存のツールはハード情報だけ、ソフト情報だけ、GUI出力のみなどで目的に合わず、自作することにしました。
開発言語はC#を選択し、AIに相談しながら作られたのがObservePCです。作ってみると、ハード・ソフト情報を網羅でき、PC管理にも使えると判明。
LAN経由の出力があれば便利ですが、初心者向けに複雑な操作を避けるため、OutputSender.csはコメントアウトで提供。
システム管理者ならC#程度は扱えると想定し、拡張可能な構成にしました。
AIに「適切な指示（プロンプト）」を与えなければ意図通りに動作しないという話はよく語られますが、これは人間同士でも同じ。
病院で症状をうまく伝えられないと診断が難しいように、人対人・人対AIの情報応答をプロトコルと見立てたのが「人通信プロトコル(仮説)」です。
「AIに合わせて人間が入力を工夫する」のではなく、情報処理技術で摩擦を乗り越えるべき。この思想を共有して下さる方のためにソースを添付・公開します。

【改変について】
- 	C#ソースファイルを同梱
- 	例：ディスプレイ情報の複数取得対応（※break文削除で有効）、イベントログ抽出件数の拡張（※現在は10件）など
- 	OutputSender.csはすべてコメントアウト済み。必要に応じて設定・書き換えてご自身でビルドしてください。
- 	LAN送信を使うならstatic void Main(string[] args)最後の終了待機Console.WriteLine("完了しました。何かキーを押すと終了します。");と次のConsole.ReadKey();をコメントアウト推奨。
- 	LAN送信を使うなら端末PCでのスタートアップなど自動実行の設定も必要です。
- 	改変での推奨環境VS2022,.NET Framework4.8
- 	一般的な用途に最適化された構成ですが、自由な改変が可能です

【C#初心者へ】
同梱のSource code_1.5.cs.txtをVisual Studioで簡単に動かすことができます。
1. Visual Studio 2022 を起動し、「新しいプロジェクトの作成」を選びます。
2. 「C#」「.NET Framework」「コンソールアプリ」を選びます。
3. プロジェクト名は自由に設定してください（例：ObservePC_Test）。
4. 作成された `Program.cs` に、同梱の `Source code_1.5.cs.txt` の内容をすべてコピー＆貼り付けします。
5. 【参照の追加が必要な場合】コード冒頭の using 文が赤くエラーになる場合は、ソリューションエクスプローラーから「参照の追加」を行い、System.Management と Microsoft.Win32 を手動で追加してください。
6. PowerShellのバージョン確認は、PowerShellを管理者で実行し、コマンド $PSVersionTable.PSVersion で確認可能です。
7. コピーが完了したら、上部の「開始」ボタンを押すと実行されます。

最初は「参照の追加」や「usingのエラー」でつまずくかもしれませんが、  
それを乗り越えると、コードが動く楽しさが一気に広がります。  
詳しい操作方法は、書籍・Web・AIなどを活用して調べてみてください。

【次バージョンへ向けての課題】
メソッド毎のWMIやPowerShell読み出しが発生するので実行速度が遅い。
一度読み出したらメモリ保持して後続の処理で再利用する方向が良さそう。
また、別種の読み込みは並列処理できれば高速化出来そうだが、全体構造を変更するので
大規模な書き換えが発生しそう。次期バージョンでの課題とします。
またPowerShellでの管理者権限必要を廃止したいので、その点も改修予定。
VRAM容量取得もDXGI取得を試みて失敗したらWMIへ変更なロジックへ変更したい。
AIとの連携を強化するためにJSON形式ファイルを出力へ。
Ver1.5までは「C#入門」的なコードでしたが、次期Verからは実行速度優先にテクニカルなコードになる予定。

【開発におけるAI利用について】
ObservePCの開発には、Copilotをはじめとした生成AIを活用しています。
WMIクエリやイベントログAPIの構文補完など、定型的で冗長になりやすい部分をAIが支援し、
設計・構造・出力整形・安全設計などの核心部分は人間が設計しました。

本ツールは「AIに理解させるための情報整形」を目的としていますが、
その開発過程自体もAIとの協働によって進められた点が特徴です。
AIを「補助的な開発パートナー」として活かすことにより、
より安全で読みやすく、AI時代に適したツールに仕上げています。

【ライセンス】
- 	LICENSE.txtに記載されている通り、以下の条件でご利用ください。
- 	自由な改変・再配布・商用利用を許可
- 	不正利用（マルウェア組み込み、監視目的など）は禁止
- 	公共性と痕跡整形の意図を尊重した利用を歓迎します
